<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Vuku</title>
<meta name="theme-color" content="#ffffff" />
<link rel="manifest" href="manifest.json" />
<link rel="apple-touch-icon" href="assets/icon-192.png" />
<style>
  :root{
    --bg:#fff; --ink:#202428; --muted:#5f6368; --line:#dfe1e5; --brand:#1a73e8; --pill:#f8f9fa; --maxw:1200px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;line-height:1.58}
  a{text-decoration:none;color:inherit}
  
  /* Üst Arama Barı */
  .topbar{display:none;position:sticky;top:0;background:#fff;z-index:8;border-bottom:1px solid var(--line)}
  .topwrap{max-width:var(--maxw);margin:0 auto;padding:10px 16px;display:flex;align-items:center;gap:16px}
  .brand{font-size:22px;font-weight:800;cursor:pointer; display: flex; align-items: center; gap: 8px;}
  .brand img{height: 30px;}
  .searchwrap{flex:1;display:flex;align-items:center;border:1px solid var(--line);border-radius:999px;padding:10px 14px;background:#fff}
  .searchwrap input{flex:1;border:0;outline:0;font-size:16px;background:transparent}

  /* Ana Sayfa Stilleri */
  .home {
      min-height: 100svh;
      display: grid;
      place-items: center;
  }
  .home .inner {
      width: 100%;
      max-width: 580px;
      margin-top: -15vh;
      padding: 0 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
  }
  /* Logo ve Marka Adı ("Vuku") */
.biglogo {
    margin-bottom: 40px; /* Arama çubuğu ile arasındaki boşluk */
    text-align: center;
    display: flex; /* İçindeki öğeleri (resim ve span) flex ile düzenle */
    flex-direction: column; /* Dikey olarak alt alta sırala */
    align-items: center; /* Yatayda ortala */
}
.biglogo img {
    height: 72px; /* Logo 'V' yüksekliği */
    /* margin-bottom: 16px; // Artık span altında olduğu için bu boşluğa gerek yok, silebiliriz. */
}
.biglogo span {
    font-size: 60px; /* "Vuku" yazısının boyutu */
    font-weight: 700;
    line-height: 1;
    margin-top: 16px; /* Yazıyı logonun V'sinden biraz aşağıya it */
    background: linear-gradient(90deg, #3c82f8, #25c7f8);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
  .bigsearch {
      width: 100%;
      display: flex;
      align-items: center;
      border: 1px solid #dfe1e5;
      border-radius: 999px;
      padding: 5px 8px 5px 20px;
      background: #fff;
      box-shadow: 0 1px 6px rgba(32,33,36,.28);
      transition: box-shadow 0.2s;
  }
  .bigsearch:hover {
      box-shadow: 0 2px 8px rgba(32,33,36,.35);
  }
  .bigsearch input {
      flex: 1;
      border: 0;
      outline: 0;
      font-size: 16px;
      background: transparent;
      padding: 8px 0;
  }
  .sbtn {
      background: transparent;
      border: 0;
      padding: 9px 16px;
      cursor: pointer;
      color: #80868b;
      font-size: 14px;
      font-weight: 500;
  }

  /* Sonuç Sayfası Stilleri */
  .tabs{display:flex;gap:22px;border-bottom:1px solid var(--line);color:var(--muted);font-size:14px; flex-wrap: wrap;}
  .tab{padding:12px 2px;cursor:pointer}
  .tab.active{color:var(--brand);border-bottom:3px solid var(--brand);margin-bottom:-1px}
  .container{max-width:var(--maxw);margin:0 auto;padding:0 16px}
  .maincol{max-width:800px}
  .section{margin-top:24px}
  .section-title{font-size:20px;font-weight:600;margin:0 0 14px}
  .result{padding:14px 6px;border-bottom:1px solid var(--line)}
  .site-line{display:flex;align-items:center;gap:8px;color:#5f6368;font-size:13px;margin-bottom:4px}
  .favicon{width:18px;height:18px;border-radius:4px;display:inline-grid;place-items:center;font-size:11px;font-weight:700;color:#fff}
  .title{font-size:20px;font-weight:400;margin:0 0 4px; color: #1a0dab;}
  .snippet{color:#4d5156;margin:0; font-size: 14px;}
  .images-grid{display:grid;grid-template-columns:repeat(auto-fill, minmax(180px, 1fr));gap:14px}
  .imgcard{display:flex;flex-direction:column;gap:6px}
  .img{width:100%;aspect-ratio:4/3;border-radius:18px;background:var(--pill);border:1px solid var(--line); background-size: cover; background-position: center;}
  .imgcap{font-size:13px;color:#3c4043}
  .news-top{display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:20px;margin-top:14px}
  .news-card-top{border:1px solid var(--line);border-radius:12px;overflow:hidden;background:#fff; transition: box-shadow 0.2s;}
  .news-card-top:hover{box-shadow: 0 2px 8px rgba(0,0,0,0.1);}
  .nthumb{width:100%;height:140px;background:var(--pill);border-bottom:1px solid var(--line); background-size: cover; background-position: center;}
  .news-content{padding: 12px;}
  .newssite{display:flex;align-items:center;gap:8px;color:#5f6368;font-size:12px;margin-bottom:6px}
  .news-h{font-size:18px;line-height:1.35;margin:0 0 6px; color: #1a0dab; font-weight: 400;}
  footer{border-top:1px solid var(--line);padding:16px;text-align:center;color:#8a94a6;font-size:12px;margin-top:40px}
  /* YENİ: Mobil Cihazlar İçin Düzeltme */
@media (max-width: 600px) {
  .biglogo img {
    height: 60px; /* Mobil için logoyu biraz küçültelim */
    margin-bottom: 12px;
  }
  .biglogo span {
    font-size: 48px; /* Mobil için yazıyı biraz küçültelim */
    margin-top: 12px;
  }
  
  /* GÖRSEL GALERİSİ İÇİN KURAL (Zaten sizde var, burada da bulunsun) */
  .images-grid { 
    grid-template-columns: repeat(2, 1fr); 
  }
}
</style>
</head>
<body>

<section id="home" class="home">
  <div class="inner">
    <div class="biglogo">
      <img src="assets/logo.png" alt="Vuku Logo" />
      <span>Vuku</span>
    </div>
    <form id="homeForm" class="bigsearch">
      <input id="homeQ" placeholder="Ara..." autocomplete="on" />
      <button class="sbtn" type="submit">Ara</button>
    </form>
  </div>
</section>

<header id="topbar" class="topbar">
  <div class="topwrap">
    <a class="brand" href="/" onclick="goHome();return false" aria-label="Vuku">
      <img src="assets/logo.png" alt="Vuku Logo" />
    </a>
    <form id="barForm" class="searchwrap">
      <input id="barQ" placeholder="Ara..." />
      <button class="sbtn" type="submit">Ara</button>
    </form>
  </div>
  <div class="topwrap">
    <nav class="tabs" id="tabs">
      <div class="tab active" data-kind="all">Tümü</div>
      <div class="tab" data-kind="image">Görseller</div>
      <div class="tab" data-kind="news">Haberler</div>
    </nav>
  </div>
</header>

<main id="results" class="container" style="display:none">
  <div id="mount"></div>
</main>

<footer>© <span id="y"></span> Vuku • <a href="#" onclick="installPrompt && installPrompt.prompt()">Ana ekrana ekle</a></footer>

<script>
const $ = s => document.querySelector(s);
$("#y").textContent = new Date().getFullYear();
let installPrompt=null; window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();installPrompt=e;});
function goHome(){ history.pushState({}, "", location.pathname); render(); }
function escapeHTML(t){ return (t||"").replace(/[&<>"]/g, m => ({ "&":"&amp;","<":"&lt;",">":"&gt;" }[m])); }
function colorFrom(str){ let h=0; for(let i=0;i<str.length;i++){h=(h*31+str.charCodeAt(i))>>>0;} return `hsl(${h%360} 65% 50%)`; }
function faviconHTML(name, icon){
  if(icon) return `<img class="favicon" src="${icon}" alt="">`;
  const ch=(name||'?').trim()[0]?.toUpperCase()||'?';
  const bg=colorFrom(name||'site');
  return `<span class="favicon" style="background:${bg}">${escapeHTML(ch)}</span>`;
}
function siteLineHTML(site, path, icon){ return `<div class="site-line">${faviconHTML(site, icon)}<span>${escapeHTML(site)}</span>${path?` · <span>${escapeHTML(path)}</span>`:""}</div>`; }
function norm(s){ return (s||"").toLowerCase().replace(/ı/g,"i").replace(/ş/g,"s").replace(/ğ/g,"g").replace(/ç/g,"c").replace(/ö/g,"o").replace(/ü/g,"u"); }
function expandQuery(q){
  const base = norm(q), words = Array.from(new Set(base.split(/\s+/).filter(Boolean)));
  const syn = new Set(words);
  if(words.some(w=>w.includes("balamar") || w.includes("nefise"))) syn.add("holding").add("servet");
  return Array.from(syn);
}
function rank(items, q){
  const qn = norm(q), terms = expandQuery(q);
  return (items||[]).map(it=>{
    const t = norm(it.title||""), d = norm(it.description||""), g = norm((it.tags||[]).join(" "));
    let sc=0;
    if(t.includes(qn)) sc+=10; if(g.includes(qn)) sc+=6; if(d.includes(qn)) sc+=4;
    terms.forEach(w=>{ if(!w) return; if(t.includes(w)) sc+=3; if(g.includes(w)) sc+=2; if(d.includes(w)) sc+=1; });
    if(t.startsWith(terms[0]||"")) sc+=2;
    if(it.boost) sc+=it.boost;
    return {...it,_score:sc};
  }).filter(x=>x._score>0).sort((a,b)=>b._score-a._score);
}
function renderOrganic(list){ return `<div class="maincol">${list.map(it=>`<article class="result">${siteLineHTML(it.site_name, it.path, it.site_icon)}<h3 class="title"><a href="#">${escapeHTML(it.title)}</a></h3><p class="snippet">${escapeHTML(it.description||"")}</p></article>`).join("")}</div>`; }
function renderImages(list){
  if(!list.length) return "";
  return `<section class="section"><h2 class="section-title">Görseller</h2><div class="images-grid">${list.map(im=>`<a href="#" class="imgcard"><div class="img" style="background-image:url('${im.thumb}')"></div><figcaption class="imgcap">${escapeHTML(im.title)}</figcaption></a>`).join("")}</div></section>`;
}
function renderNews(list){
  if(!list.length) return "";
  return `<section class="section maincol"><h2 class="section-title">Haberler</h2><div class="news-top">${list.map(n=>`<a href="#" class="news-card-top"><div class="nthumb" style="background-image:url('${n.thumb}')"></div><div class="news-content"><div class="newssite">${faviconHTML(n.source, n.source_icon)}<span>${escapeHTML(n.source)}</span> · <span>${(new Date(n.published_at)).toLocaleDateString('tr-TR')}</span></div><h3 class="news-h">${escapeHTML(n.title)}</h3></div></a>`).join("")}</div></section>`;
}
function byKind(items, kind){ return (kind==="all") ? (items||[]) : (items||[]).filter(x => (x.kind||"article")===kind); }
function draw(kind, q){
  const all = window.__allItems||[];
  if (kind === "all") {
    const articles = rank(all.filter(x=>x.kind === "article"), q).slice(0, 10);
    const news = rank(all.filter(x=>x.kind === "news"), q).slice(0, 3);
    const images = rank(all.filter(x=>x.kind === "image"), q).slice(0, 5);
    $("#mount").innerHTML = renderOrganic(articles) + renderNews(news) + renderImages(images);
  } else if (kind === "image") {
    $("#mount").innerHTML = renderImages(rank(byKind(all, "image"), q));
  } else if (kind === "news") {
    $("#mount").innerHTML = renderNews(rank(byKind(all, "news"), q));
  }
}
function handleSearch(q) { if(!q) return; const u=new URL(location.href); u.searchParams.set("q",q); u.searchParams.delete("kind"); history.pushState({}, "", u); render(); }
$("#homeForm").addEventListener("submit", e=>{ e.preventDefault(); handleSearch($("#homeQ").value.trim()); });
$("#barForm").addEventListener("submit", e=>{ e.preventDefault(); handleSearch($("#barQ").value.trim()); });
$("#tabs").addEventListener("click", e=>{ const t=e.target.closest(".tab"); if(!t) return; const u=new URL(location.href); u.searchParams.set("kind", t.dataset.kind); history.pushState({}, "", u); render(); });
window.addEventListener("popstate", render);
async function render(){
  const P=new URLSearchParams(location.search); const q=P.get("q"); const kind=P.get("kind")||"all";
  const home=$("#home"), topbar=$("#topbar"), res=$("#results");
  if(!q){ home.style.display="grid"; topbar.style.display="none"; res.style.display="none"; return; }
  home.style.display="none"; topbar.style.display="block"; res.style.display="block";
  $("#barQ").value=q;
  document.querySelectorAll(".tab").forEach(el=>el.classList.toggle("active", el.dataset.kind===kind));
  if (!window.__allItems) {
    try {
        const data = await fetch("./search-data.json?v=2").then(r=>r.json());
        window.__allItems = data.items || [];
    } catch(err) {
        console.warn("Veri yüklenemedi:", err); window.__allItems = [];
    }
  }
  draw(kind, q);
}
if('serviceWorker' in navigator){ navigator.serviceWorker.register('./sw.js').catch(()=>{}); }
render();
</script>
</body>
</html>
